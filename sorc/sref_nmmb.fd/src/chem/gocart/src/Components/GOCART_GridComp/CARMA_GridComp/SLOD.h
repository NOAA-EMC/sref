
!     Interface to SLOD_Coupler (needed because of optional arguments)
      interface
       subroutine SLOD_Coupler( i1, i2, j1, j2, km, nbeg, nend   &
                                      , NGROUP, NELEM, NBIN, NGAS        &
                                      , w_c, dtime &
                                      , t, rhoa &
                                      , t_sfc, p_surf &
                                      , ifall, rhflag                    &
                                      , r, rlow, rup  &
                                      , rmin, rmrat &
                                      , rhop, fluxout &
                                      , rc )

       use SLOD_ChemMod

       implicit none

!      Inputs (required)
       integer :: i1, i2, j1, j2, km, nbeg, nend
       integer :: NGROUP, NELEM, NBIN, NGAS

!      Optional I/O
       type(Chem_Bundle), optional                        :: w_c
       real(kind=f), optional                             :: dtime
       real(kind=f), dimension(i1:i2,j1:j2,km), optional  :: t, rhoa
       real(kind=f), dimension(i1:i2,j1:j2), optional     :: t_sfc, p_surf
       integer, optional                                  :: ifall, rhflag
       real(kind=f), dimension( NBIN, NGROUP ), optional  :: r, rlow, rup, rhop
       real(kind=f), dimension( NGROUP ), optional        :: rmin, rmrat
       type(Chem_Array), pointer, dimension(:), optional  :: fluxout
       integer, optional                                  :: rc
       end subroutine SLOD_Coupler
      end interface

!     Here is an example profile suitable for a 32-level (km = 32)
!     simulation (these come from a GEOS-4 c32 monthly average diag.eta file)
      data a32/40.00000,     106.00000,     224.00000,     &
              411.00000,     685.00000,    1065.00000,     &
             1565.00000,    2179.80000,    2900.00000,     &
             3680.00000,    4550.00000,    5515.00000,     &
             6607.00000,    7844.00000,    9236.56616,     &
            10866.34280,   12783.70000,   15039.29900,     &
            17693.00000,   20815.20900,   24487.49020,     &
            28808.28710,   32368.63870,   33739.96480,     &
            32958.54300,   30003.29880,   24930.12700,     &
            18568.89060,   12249.20510,    6636.21191,     &
             2391.51416,       0.00000,       0.00000 /
      data b32/ 0.00000,       0.00000,       0.00000,     &
                0.00000,       0.00000,       0.00000,     &
                0.00000,       0.00000,       0.00000,     &
                0.00000,       0.00000,       0.00000,     &
                0.00000,       0.00000,       0.00000,     &
                0.00000,       0.00000,       0.00000,     &
                0.00000,       0.00000,       0.00000,     &
                0.00000,       0.01523,       0.06132,     &
                0.13948,       0.25181,       0.39770,     &
                0.55869,       0.70853,       0.83693,     &
                0.93208,       0.98511,       1.00000 /

      data t32      /  259.467, 260.792, 253.621, 241.267, 234.818, 230.578, 225.268, 219.438, &
                       213.691, 209.818, 206.200, 201.923, 196.798, 193.717, 195.378, 199.580, &
                       202.377, 209.173, 217.290, 225.792, 234.747, 243.395, 253.052, 260.788, &
                       268.801, 275.221, 281.445, 287.143, 291.649, 292.447, 295.072, 296.932 /
      data rhoa32      / 0.000909566, 0.00210746, 0.00423304, 0.00774650, 0.0127762, &
                         0.0196278, 0.0286969, 0.0400545, 0.0533895, 0.0680774, &
                         0.0847800, 0.104315, 0.127634, 0.153273, 0.178851, 0.205977, &
                         0.238968, 0.271987, 0.308021, 0.348708, 0.394551, 0.447781, &
                         0.507138, 0.579787, 0.662871, 0.761525, 0.865102, 0.960593, &
                         1.04275, 1.11274, 1.15051, 1.16934 /

      data a72 / &
       1.0000000,       2.0000002,       3.2700005,       4.7585009,       6.6000011, &
       8.9345014,       11.970302,       15.949503,       21.134903,       27.852606, &
       36.504108,       47.580610,       61.677911,       79.513413,       101.94402, &
       130.05102,       165.07903,       208.49704,       262.02105,       327.64307, &
       407.65710,       504.68010,       621.68012,       761.98417,       929.29420, &
       1127.6902,       1364.3402,       1645.7103,       1979.1604,       2373.0405, &
       2836.7806,       3381.0007,       4017.5409,       4764.3911,       5638.7912, &
       6660.3412,       7851.2316,       9236.5722,       10866.302,       12783.703, &
       15039.303,       17693.003,       20119.201,       21686.501,       22436.301, &
       22389.800,       21877.598,       21214.998,       20325.898,       19309.696, &
       18161.897,       16960.896,       15625.996,       14290.995,       12869.594, &
       11895.862,       10918.171,       9936.5219,       8909.9925,       7883.4220, &
       7062.1982,       6436.2637,       5805.3211,       5169.6110,       4533.9010, &
       3898.2009,       3257.0809,       2609.2006,       1961.3106,       1313.4804, &
       659.37527,       4.8048257,       0.0000000 /

      data b72 / &
       0.0000000,       0.0000000,       0.0000000,       0.0000000,       0.0000000, &
       0.0000000,       0.0000000,       0.0000000,       0.0000000,       0.0000000, &
       0.0000000,       0.0000000,       0.0000000,       0.0000000,       0.0000000, &
       0.0000000,       0.0000000,       0.0000000,       0.0000000,       0.0000000, &
       0.0000000,       0.0000000,       0.0000000,       0.0000000,       0.0000000, &
       0.0000000,       0.0000000,       0.0000000,       0.0000000,       0.0000000, &
       0.0000000,       0.0000000,       0.0000000,       0.0000000,       0.0000000, &
       0.0000000,       0.0000000,       0.0000000,       0.0000000,       0.0000000, &
       0.0000000,   8.1754130e-09,    0.0069600246,     0.028010041,     0.063720063, &
      0.11360208,      0.15622409,      0.20035011,      0.24674112,      0.29440312, &
      0.34338113,      0.39289115,      0.44374018,      0.49459020,      0.54630418, &
      0.58104151,      0.61581843,      0.65063492,      0.68589990,      0.72116594, &
      0.74937819,      0.77063753,      0.79194696,      0.81330397,      0.83466097, &
      0.85601798,      0.87742898,      0.89890800,      0.92038701,      0.94186501, &
      0.96340602,      0.98495195,       1.0000000 /
